# GitLab CI Pipeline Ruleset

## Pipeline Structure
- GitLab CI pipelines must contain exactly three stages: `build`, `test`, and `container-build`
- Stage names must be exactly: `build`, `test`, `container-build`
- No additional stages are permitted
- Stages must be defined in the order: `build`, `test`, `container-build`

## Stage Requirements

### Build Stage
- The `build` stage must be the first stage in the pipeline
- Jobs in the `build` stage should handle compilation, dependency installation, or artifact preparation

### Test Stage
- The `test` stage must be the second stage in the pipeline
- Jobs in the `test` stage should execute tests and validation
- The `test` stage must depend on the `build` stage

### Container Build Stage
- The `container-build` stage must be the third and final stage in the pipeline
- The `container-build` stage must use a local ECR registry
- Jobs in the `container-build` stage must authenticate with and push to the local ECR registry
- The `container-build` stage must depend on the `test` stage
- Container images must be built and pushed to the local ECR registry endpoint

## ECR Registry Configuration
- Container build jobs must configure ECR authentication using local registry credentials
- ECR registry URL must point to a local ECR instance
- Docker login must be performed before building and pushing containers
- Container images must be tagged appropriately for the local ECR registry

## Pipeline Validation
- All pipelines must strictly adhere to the three-stage structure
- No stages beyond `build`, `test`, and `container-build` are allowed
- Stage dependencies must follow the sequence: `build` → `test` → `container-build`
- Each stage must contain at least one job

